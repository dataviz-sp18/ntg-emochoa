---
title: 'Accio Title!'
author: 'Erin M. Ochoa'
date: '2018 May 29'
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    theme: flatly
---

```{r setup, include=FALSE}
library(hash)
library(stringr)
#library(SnowballC)
library(stopwords)
#library(textclean)
library(data.table)
library(wordcloud2)
library(harrypotter)
library(flexdashboard)
```


```{r define_funks}
clean_book <- function(book){
    local_book <- book
    local_book <- str_to_lower(local_book)
    #local_book <- replace_contraction(local_book)
    local_book <- gsub("'s",'',local_book)
    #local_book <- gsub('[[:punct:] ]+',' ',local_book)
    local_book <- gsub('[[:digit:] ]+',' ',local_book)
    local_book_list <- unlist(str_split(local_book, boundary('word')))
    s.words <- stopwords()
    local_book_list <- local_book_list[!(local_book_list)%in%stopwords()]
    #local_book_clean <- wordStem(local_book_list)
    
    # Remove contractions
    # Remove punctuation
    # Remove plurals
    # Split into string
    # Remove stopwords
    # Return list of words
}
```

```{r clean_text}
books <- c(philosophers_stone,
           chamber_of_secrets,
           prisoner_of_azkaban,
           goblet_of_fire,
           order_of_the_phoenix,
           half_blood_prince,
           deathly_hallows)

clean.ps <- clean_book(philosophers_stone)

#clean.ps
```


```{r make_dicto}
dicto <- function(clean_book){
  dicto <- hash()
  for(i in 1:length(clean_book)){
    word <- clean_book[i]
    ct <- dicto[[as.character(eval(word))]]
    if(is.null(ct)){
      dicto[[as.character(eval(word))]] <- 1
    }
    else{
      dicto[[as.character(eval(word))]] <- (ct + 1)
    }
  }
  dicto
}

dicto.ps <- dicto(clean.ps)
df.ps <- as.data.frame(hash::values(dicto.ps))
df.ps <- setDT(df.ps, keep.rownames = TRUE)[]
colnames(df.ps) <- c('word','freq')
wordcloud2(df.ps)
```